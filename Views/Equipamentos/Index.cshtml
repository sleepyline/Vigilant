@model IEnumerable<VigiLant.Models.Equipamento>
@{
    ViewData["Title"] = "Equipamentos";
}

<div class="page-header">
    <h1 class="page-title">Equipamentos</h1>
    <div class="breadcrumb">
        <a href="@Url.Action("Index", "Home")">Dashboard</a>
        <span class="separator">/</span>
        <span class="active">Equipamentos</span>
    </div>
</div>

<div class="page-actions">
    <div></div>
    <div class="btts">
        <button type="button" class="btn-primary" id="btnAddEquipamento" data-action-type="create-modal"
            data-url="@Url.Action("Create", "Equipamentos")" data-title="Adicionar Novo Equipamento" data-form-id="equipamentoForm">
            <i class="fas fa-plus"></i>
            Adicionar Novo Equipamento
        </button>
    </div>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Localização</th>
                <th>Tópico</th>
                <th>Status</th>
                <th>Tipo Sensor</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var equipamento in Model)
            {
                <tr>
                    <td>#@equipamento.Id</td>
                    <td>@equipamento.Nome</td>
                    <td>@equipamento.Localizacao</td>
                    <td>@equipamento.Topico</td>
                    <td>
                        @{
                            var statusClass = equipamento.Status switch
                            {
                                "Ativo" => "success",
                                "Inativo" or "ErroInicial" => "danger",
                                _ => "warning"
                            };
                        }
                        <span class="status-badge @statusClass">
                            @equipamento.Status
                        </span>
                    </td>
                    <td>@(string.IsNullOrEmpty(equipamento.TipoSensor) ? "Pendente" : equipamento.TipoSensor)</td>
                    <td>
                        <div class="table-actions">

                            <button type="button" class="btn-icon btn-ajax-modal" title="Editar" data-id="@equipamento.Id"
                                data-action-type="edit" data-controller-url="@Url.Content("~/Equipamentos")"
                                data-title="Editar Equipamento #{ID}" data-form-id="editEquipamentoForm">
                                <i class="fas fa-edit"></i>
                            </button>

                            <button type="button" class="btn-icon btn-ajax-modal" title="Ver Detalhes" data-id="@equipamento.Id"
                                data-action-type="details" data-controller-url="@Url.Content("~/Equipamentos")"
                                data-title="Detalhes do Equipamento #{ID}">
                                <i class="fas fa-eye"></i>
                            </button>

                            <button type="button" class="btn-icon btn-ajax-modal text-danger" title="Excluir"
                                data-id="@equipamento.Id" data-action-type="delete" data-controller-url="@Url.Content("~/Equipamentos")"
                                data-title="Confirmação de Exclusão #{ID}" data-form-id="deleteForm">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<div id="ajax-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h5 id="modalTitle">Título</h5> <button id="closeModalButton" ...>X</button>
        </div>
        <div id="modalBody" class="modal-body"> </div>
    </div>
</div>

@section Scripts {
    @* Assumindo que você já tem o Partialjs.js no local correto *@
    <script src="/js/Partialjs.js" asp-append-version="true"></script> 
}